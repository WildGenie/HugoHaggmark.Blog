<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Taskmanager</title>
</head>
<body>
    <canvas id="canvas" height="450" width="600"></canvas>

    <script src="Scripts/jquery-1.10.2.min.js"></script>
    <script src="Scripts/jquery.signalR-2.0.0.min.js"></script>
    <script src="Scripts/chart.min.js"></script>
    <script src="/signalr/hubs"></script>
    <script type="text/javascript">
        var cpuHub = $.connection.cpuHub;

        var lineChartData = {
            labels: [""],
            datasets: [
                {
                    fillColor: "rgba(241,246,250,0.5)",
                    strokeColor: "rgba(17,125,187,1)",
                    pointColor: "rgba(17,125,187,1)",
                    pointStrokeColor: "#fff",
                    data: [0]
                }
            ]
        };

        var options = {

            //Boolean - If we want to override with a hard coded scale
            scaleOverride: true,

            //** Required if scaleOverride is true **
            //Number - The number of steps in a hard coded scale
            scaleSteps: 10,
            //Number - The value jump in the hard coded scale
            scaleStepWidth: 10,
            //Number - The scale starting value
            scaleStartValue: 0,

            //String - Colour of the scale line	
            scaleLineColor: "rgba(0,0,0,.1)",

            //Number - Pixel width of the scale line	
            scaleLineWidth: 1,

            //Boolean - Whether to show labels on the scale	
            scaleShowLabels: true,

            //Interpolated JS string - can access value
            scaleLabel: "<%=value%>",

            //String - Scale label font declaration for the scale label
            scaleFontFamily: "'Arial'",

            //Number - Scale label font size in pixels	
            scaleFontSize: 12,

            //String - Scale label font weight style	
            scaleFontStyle: "normal",

            //String - Scale label font colour	
            scaleFontColor: "#666",

            ///Boolean - Whether grid lines are shown across the chart
            scaleShowGridLines: true,

            //String - Colour of the grid lines
            scaleGridLineColor: "rgba(0,0,0,.05)",

            //Boolean - Whether the line is curved between points
            bezierCurve: false,

            //Boolean - Whether to show a dot for each point
            pointDot: false,

            //Boolean - Whether to animate the chart
            animation: false,
        };

        cpuHub.client.cpuInfo = function (machineName, cpu) {
            if (lineChartData.labels.length > 20) {
                lineChartData.labels.shift();
            }

            lineChartData.labels.push("");

            if (lineChartData.datasets[0].data.length > 20) {
                lineChartData.datasets[0].data.shift();
            }

            lineChartData.datasets[0].data.push(cpu);

            var chart = new Chart(document.getElementById("canvas").getContext("2d")).Line(lineChartData, options);
        }

        $.connection.hub.start();
    </script>
</body>
</html>
